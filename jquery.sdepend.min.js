(function($){$.fn.sdepend=function(dsPath,params){dsPath+=$.tappend;var jsonData=null,tempData=null;if(!params.fromQry||params.fromQry!==true){jsonData=$.hasSub($.getDSet(dsPath,params.imgLoad),params);tempData=$.procData(jsonData,params)}else{jsonData=$.hasSub($.postDSet(dsPath,params.depChecks,params.imgLoad),params);tempData=$.procPostData(jsonData,params)}var opts=$.prepOptions(tempData,params);$(this).html(opts);return $(this)};$.procData=function(data,params){var newObj=[],kc=0,cd=params.depChecks;
if(cd&&cd.keys)kc=cd.keys.length;$.each(data,function(k,v){var check=eval($.getConditionStr(v,kc,cd));if(check)if(!params.optFields||params.optFields.length<=0)newObj.push(new $.OptObj(v,v));else if(params.optFields&&params.optFields.length==1)newObj.push(new $.OptObj(v[params.optFields[0]],v[params.optFields[0]]));else newObj.push(new $.OptObj(v[params.optFields[0]],v[params.optFields[1]]))});return newObj};$.procPostData=function(data,params){var newObj=[];$.each(data,function(k,v){if(!params.optFields||
params.optFields.length<=0)newObj.push(new $.OptObj(v,v));else if(params.optFields&&params.optFields.length===1)newObj.push(new $.OptObj(v[params.optFields[0]],v[params.optFields[0]]));else newObj.push(new $.OptObj(v[params.optFields[0]],v[params.optFields[1]]))});return newObj};$.prepOptions=function(data,params){var opts='<option value="none">Select One...</option>';$.each(data,function(k,v){var ct="";if(params.autoSelect&&params.autoSelect===true)ct=v.val==params.autoValue?' selected="selected"':
"";opts+='<option value="'+v.val+'" '+ct+">"+v.text+"</option>"});return opts};$.getDSet=function(dsPath,hideId){var mydata=null;$.ajax({type:"GET",url:dsPath,dataType:"json",async:false,success:function(data){mydata=data},complete:function(){$("#"+hideId).hide()}});return mydata};$.postDSet=function(dsPath,req,hideId){var mydata=null;var reqData=$.buildPostData(req);$.ajax({type:"POST",url:dsPath,data:reqData,dataType:"json",async:false,success:function(data){mydata=data},complete:function(){$("#"+
hideId).hide()}});return mydata};$.getConditionStr=function(val,kc,checkDet){var evalStr="";if(kc<=0)evalStr="true";else{var first=true;for(var i=0;i<kc;i++){if(!first)evalStr+=" && ";evalStr+="'"+val[checkDet.keys[i]]+"'"+" == "+"'"+checkDet.vals[i]+"'";first=false}}return evalStr};$.buildPostData=function(req){var pd={};for(var i=0;i<req.keys.length;i++)pd[req.keys[i]]=req.vals[i];return pd};$.hasSub=function(jsonData,params){var jd=$.extend(true,{},jsonData);if(params.subKey&&params.subKey!=="")jd=
jd[params.subKey];return jd};$.OptObj=function(val,text){this.val=val;this.text=text};$.tappend="?tmt="+(new Date).getTime();$.removeByAttr=function(arr,attr,value){var tArr=arr.slice(),i=tArr.length;while(i--)if(tArr[i]&&(tArr[i].hasOwnProperty(attr)&&(arguments.length>2&&tArr[i][attr]===value)))tArr.splice(i,1);return tArr}})(jQuery);
